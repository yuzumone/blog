<!doctype html><html lang=ja-jp dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Microsoft Graph API Calendar | yuzumone's blog</title>
<meta name=description content="
    
  "><meta name=keywords content="
    
  "><style>@import 'https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+JP:wght@400;600&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Noto+Color+Emoji&family=Secular+One&display=swap'</style><link rel=stylesheet href=/css/main.min.c920c6820985c10fbbdc90a35fcfbbe126b074dade8529dee052ec789f76adaa.css integrity="sha256-ySDGggmFwQ+73JCjX8+74SawdNrehSne4FLseJ92rao=" crossorigin=anonymous><style>.bg{background-color:#f8f8f8}.chroma{background-color:#f8f8f8}.chroma .x{color:#000}.chroma .err{color:#a40000}.chroma .cl{}.chroma .lnlinks{outline:none;text-decoration:none;color:inherit}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0}.chroma .hl{background-color:#dfdfdf}.chroma .lnt{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .ln{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .line{display:flex}.chroma .k{color:#204a87;font-weight:700}.chroma .kc{color:#204a87;font-weight:700}.chroma .kd{color:#204a87;font-weight:700}.chroma .kn{color:#204a87;font-weight:700}.chroma .kp{color:#204a87;font-weight:700}.chroma .kr{color:#204a87;font-weight:700}.chroma .kt{color:#204a87;font-weight:700}.chroma .n{color:#000}.chroma .na{color:#c4a000}.chroma .nb{color:#204a87}.chroma .bp{color:#3465a4}.chroma .nc{color:#000}.chroma .no{color:#000}.chroma .nd{color:#5c35cc;font-weight:700}.chroma .ni{color:#ce5c00}.chroma .ne{color:#c00;font-weight:700}.chroma .nf{color:#000}.chroma .fm{color:#000}.chroma .nl{color:#f57900}.chroma .nn{color:#000}.chroma .nx{color:#000}.chroma .py{color:#000}.chroma .nt{color:#204a87;font-weight:700}.chroma .nv{color:#000}.chroma .vc{color:#000}.chroma .vg{color:#000}.chroma .vi{color:#000}.chroma .vm{color:#000}.chroma .l{color:#000}.chroma .ld{color:#000}.chroma .s{color:#4e9a06}.chroma .sa{color:#4e9a06}.chroma .sb{color:#4e9a06}.chroma .sc{color:#4e9a06}.chroma .dl{color:#4e9a06}.chroma .sd{color:#8f5902;font-style:italic}.chroma .s2{color:#4e9a06}.chroma .se{color:#4e9a06}.chroma .sh{color:#4e9a06}.chroma .si{color:#4e9a06}.chroma .sx{color:#4e9a06}.chroma .sr{color:#4e9a06}.chroma .s1{color:#4e9a06}.chroma .ss{color:#4e9a06}.chroma .m{color:#0000cf;font-weight:700}.chroma .mb{color:#0000cf;font-weight:700}.chroma .mf{color:#0000cf;font-weight:700}.chroma .mh{color:#0000cf;font-weight:700}.chroma .mi{color:#0000cf;font-weight:700}.chroma .il{color:#0000cf;font-weight:700}.chroma .mo{color:#0000cf;font-weight:700}.chroma .o{color:#ce5c00;font-weight:700}.chroma .ow{color:#204a87;font-weight:700}.chroma .p{color:#000;font-weight:700}.chroma .c{color:#8f5902;font-style:italic}.chroma .ch{color:#8f5902;font-style:italic}.chroma .cm{color:#8f5902;font-style:italic}.chroma .c1{color:#8f5902;font-style:italic}.chroma .cs{color:#8f5902;font-style:italic}.chroma .cp{color:#8f5902;font-style:italic}.chroma .cpf{color:#8f5902;font-style:italic}.chroma .g{color:#000}.chroma .gd{color:#a40000}.chroma .ge{color:#000;font-style:italic}.chroma .gr{color:#ef2929}.chroma .gh{color:navy;font-weight:700}.chroma .gi{color:#00a000}.chroma .go{color:#000;font-style:italic}.chroma .gp{color:#8f5902}.chroma .gs{color:#000;font-weight:700}.chroma .gu{color:purple;font-weight:700}.chroma .gt{color:#a40000;font-weight:700}.chroma .gl{color:#000;text-decoration:underline}.chroma .w{color:#f8f8f8;text-decoration:underline}</style><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js></script><script src=/js/search.942bd26f5f9a4a6909fc6fe8467bf5e63314ad56a308f6cf706af97ea3b80f27.js integrity="sha256-lCvSb1+aSmkJ/G/oRnv15jMUrVajCPbPcGr5fqO4Dyc=" crossorigin=anonymous></script></head><body><article class=posts><header><div class=header-container><div class=flex-none><h1 class=title><a href=https://blog.yuzumone.net/>yuzumone's blog</a></h1></div><nav><ul class=flex-items><li class=header-item><a href=/>Home</a></li><li class=header-item><a href=/archives/>Archives</a></li></ul></nav></div><div class=header-line></div></header><main><div><h1 class=article-title>Microsoft Graph API Calendar</h1><div class=header-container><time datetime=2022-10-23T00:00:00+00:00>ğŸ—“ October 23, 2022</time><div class=article-tag><p class=flex-items>ğŸ·ï¸</p><ul class=flex-items><li class=header-item><a href=/tags/microsoftgraphapi>MicrosoftGraphAPI</a></li></ul></div></div></div><div><figure><img src="https://images.unsplash.com/photo-1435527173128-983b87201f4d?w=800&amp;auto=format&amp;fit=crop&amp;q=60&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxzZWFyY2h8MXx8Y2FsZW5kYXJ8ZW58MHx8MHx8fDI%3D"><figcaption><h4>Photo by Eric Rothermel on Unsplash</h4></figcaption></figure><p>æœ€è¿‘æ­¯åŒ»è€…ã«è¡Œãã¯ã˜ã‚ã¾ã—ãŸï¼ãã“ã§å›°ã‚‹ã‚ˆã†ã«ãªã£ãŸã®ãŒäºˆç´„ã§ã™ï¼<br>å®Œå…¨ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ãªã®ã§ã©ã®æ—¥æ™‚ã§ã‚‚å•é¡Œãªã„ã®ã§ã™ãŒï¼Œå€‹äººã®äºˆå®šè¡¨ã¨ä»•äº‹ã®äºˆå®šè¡¨ã‚’ã©ã¡ã‚‰ã‚‚ç¢ºèªã—ã¤ã¤æ±ºã‚ãªã„ã¨ã„ã‘ã¾ã›ã‚“ï¼<br>å€‹äººäºˆå®šè¡¨ã¨ä»•äº‹äºˆå®šè¡¨ã‚’ä¸€æ‹¬ã§è¦‹ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ï¼ŒMicrosoft Graph API ã‚’åˆ©ç”¨ã—ã¦ã‹ã‚“ãŸã‚“ãªåŒæœŸã‚’ã‚„ã£ã¦ã¿ã¾ã™ï¼<br></p><p>ã¡ãªã¿ã« API ãŒç°¡å˜ã«ä½¿ãˆã‚‹ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦ TimeTree ãŒã‚ã‚Šãã¡ã‚‰ã‚‚è©¦ã—ã¦ã¿ãŸã®ã§ã™ãŒï¼Œã‚„ã¯ã‚Šåºƒå‘ŠãŒå‡ºã¦ã—ã¾ã†ã®ã¨ API çµŒç”±ã§ç™»éŒ²ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã®åæ˜ ãŒã¡ã‚‡ã£ã¨é…ã„ã‚ˆã†ãªæ°—ãŒã—ãŸã®ã§ã‚„ã‚ã¾ã—ãŸï¼<br></p><h2 id=æ‰‹é †>æ‰‹é †</h2><p>æµã‚Œã¯ä¸‹è¨˜ã®ã¨ãŠã‚Šã§ã™ï¼<br></p><ul><li>Azure ã§ã‚¢ãƒ—ãƒªã‚’ä½œæˆã™ã‚‹<br></li><li>Token å–å¾—<br></li><li>ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆ API å©ã on Power Automate<br></li></ul><p>ã¾ãšã¯ Azure portal ã§ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¾ã™ï¼<br></p><p><a href=https://portal.azure.com/>https://portal.azure.com/</a><br></p><p>ã‚¢ãƒ—ãƒªä½œæˆå¾Œè¨­å®šã™ã‚‹ã®ã¯è¨¼æ˜æ›¸ã¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¨ API ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã§ã™ï¼<br></p><p>è¨¼æ˜æ›¸ã¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¯ã‚ˆãã‚ã‚‹ client_secret ã§ã™ï¼<br>ä½œæˆå¾Œå€¤ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ ID ã¨ã„ã†ã®ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ãŒï¼Œæ§ãˆã¦ãŠãã®ã¯å€¤ã®æ–¹ã§ã™ï¼<br>ä½œæˆå¾Œæ™‚é–“ãŒçµŒã¤ã¨å€¤ã¯è¡¨ç¤ºã•ã‚Œãªããªã‚‹ã®ã§æ°—ã‚’ã¤ã‘ã¦ãã ã•ã„ï¼<br></p><p>API ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã¯ã©ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒå©ã‘ã‚‹ã‹ã®è¨­å®šã§ã™ï¼<br>é›‘ã«è¨­å®šã—ã¦ã—ã¾ã„ã¾ã—ãŸãŒï¼Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨±å¯ã§ Calendars.Read ã¨ Calendars.ReadWrite ãŒã‚ã‚Œã°å•é¡Œãªã„ã¨æ€ã„ã¾ã™ï¼<br></p><p>Token ã®å–å¾—ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™ï¼<br></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -d <span class=s2>&#34;client_id={client_id}&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     -d <span class=s2>&#34;client_secret={client_secret}&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     -d <span class=s2>&#34;scope=https%3A%2F%2Fgraph.microsoft.com%2F.default&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     -d <span class=s2>&#34;grant_type=client_credentials&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     -H <span class=s2>&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     -X POST https://login.microsoftonline.com/<span class=o>{</span>tenant_id<span class=o>}</span>/oauth2/v2.0/token
</span></span></code></pre></div><p>è©³ç´°ã¯ã“ã¡ã‚‰ï¼<br></p><p><a href=https://learn.microsoft.com/ja-jp/graph/auth-v2-servicehttps://learn.microsoft.com/ja-jp/graph/auth-v2-service>Get access without a user - Microsoft Graph</a><br></p><p>Token ãŒå–å¾—ã§ããŸã‚‰ã‚ã¨ã¯ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆ API ã‚’å©ãã ã‘ã§ã™ï¼<br>ä»Šå›ã¯ä»•äº‹ç”¨ã®äºˆå®šè¡¨ã‚’ä½œæˆã—ã¦ï¼Œå€‹äººã®ã‚‚ã®ã¨ã¯åˆ†ã‘ã‚‹æ„Ÿã˜ã«ã—ã¾ã™ï¼<br></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -X POST -H <span class=s2>&#34;Authorization: Bearer {token}&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>      -H <span class=s2>&#34;Content-type: application/json&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>      -H <span class=s1>&#39;Prefer: outlook.timezone=&#34;TokyoStandard Time&#34;&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>      -d <span class=s1>&#39;{&#34;subject&#34;: &#34;Let\&#39;</span>s go <span class=k>for</span> lunch<span class=s2>&#34;, &#34;</span>start<span class=s2>&#34;: {&#34;</span>dateTime<span class=s2>&#34;: &#34;</span>2022-10-23T12:00:00<span class=s2>&#34;, &#34;</span>timeZone<span class=s2>&#34;: &#34;</span>Tokyo Standard Time<span class=s2>&#34;}, &#34;</span>end<span class=s2>&#34;: {&#34;</span>dateTime<span class=s2>&#34;: &#34;</span>2022-10-23T13:00:00<span class=s2>&#34;, &#34;</span>timeZone<span class=s2>&#34;: &#34;</span>Tokyo Standard Time<span class=s2>&#34;}}&#39;
</span></span></span><span class=line><span class=cl><span class=s2>&#39;https://graph.microsoft.com/v1.0/users/{user_id}/calendars/{calendar_id}/events&#39;
</span></span></span></code></pre></div><p><a href=https://learn.microsoft.com/ja-jp/graph/api/user-post-events>Create Event - Microsoft Graph v1.0</a><br></p><p>ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã«ã¤ã„ã¦ã®æƒ…å ±ï¼<br>æ—¥æœ¬ã¯ã€ŒTokyo Standard Timeã€<br></p><p><a href=https://learn.microsoft.com/ja-jp/graph/api/resources/datetimetimezone>dateTimeTimeZone resource type - Microsoft Graph v1.0</a><br></p><p>calendar_id ã¯ CalendarGroup ã‚’è¾¿ã‚‹ã¨å–å¾—ã§ãã¾ã™ï¼<br></p><p><a href=https://learn.microsoft.com/ja-jp/graph/api/calendargroup-get>Get calendarGroup - Microsoft Graph v1.0</a><br></p><p>curl ã§é›‘ã«ç¢ºèªã§ããŸã‚‰ã‚ã¨ã¯ Power Automate ã§è¨­å®šã™ã‚‹ã ã‘ã§ã™ï¼<br>å¤‰æ›´ã«è¿½éšã™ã‚‹ã®ã¯å¤§å¤‰ãªã®ã§ï¼ŒOffice ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ä¸Šè¨˜ã®ä¸€é€£ä½œæ¥­ãŒè¡Œã‚ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ï¼<br>ã¾ãŸæƒ…å ±ã®æŒã¡å‡ºã—ã«å•ã‚ã‚ŒãŸã‚‰ã‚ã‚“ã©ãã•ã„ã®ã§ï¼Œãƒˆãƒªã‚¬ãƒ¼ã•ã‚ŒãŸ Office ã‚¤ãƒ™ãƒ³ãƒˆã®æƒ…å ±ã¯æ™‚é–“æƒ…å ±ã ã‘åˆ©ç”¨ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã‚¿ã‚¤ãƒˆãƒ«ã€Œäºˆå®šã‚ã‚Šã€ã¨ã ã‘è¿½åŠ ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸï¼<br></p><p>ã“ã‚Œã§æ­¯åŒ»è€…ã•ã‚“ã§äºˆå®šæ±ºã‚ã‚‹ã‹ã‚‰ã¨ã„ã£ã¦ã‚¹ãƒãƒ›ã‚’ 2 å°çœºã‚ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã—ãŸï¼<br></p></div></main><footer><section><p>Â© 2025 yuzumone's blog All rights reserved.</p></section></footer></article></body></html>