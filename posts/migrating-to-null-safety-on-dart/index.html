<!doctype html><html lang=ja-jp dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Migrating to null safety on Dart | yuzumone's blog</title>
<meta name=description content="
    
  "><meta name=keywords content="
    
  "><meta name=Hatena::Bookmark content="nocomment"><style>@import 'https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+JP:wght@400;600&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Noto+Color+Emoji&family=Secular+One&display=swap'</style><link rel=stylesheet href=/css/main.min.2421e6cca60bf0bd0ce22a86e5391b0a7b5bbd939bf4e3d651fd3384307eba3b.css integrity="sha256-JCHmzKYL8L0M4iqG5TkbCntbvZOb9OPWUf0zhDB+ujs=" crossorigin=anonymous><style>.bg{background-color:#f8f8f8}.chroma{background-color:#f8f8f8}.chroma .x{color:#000}.chroma .err{color:#a40000}.chroma .cl{}.chroma .lnlinks{outline:none;text-decoration:none;color:inherit}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0}.chroma .hl{background-color:#dfdfdf}.chroma .lnt{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .ln{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .line{display:flex}.chroma .k{color:#204a87;font-weight:700}.chroma .kc{color:#204a87;font-weight:700}.chroma .kd{color:#204a87;font-weight:700}.chroma .kn{color:#204a87;font-weight:700}.chroma .kp{color:#204a87;font-weight:700}.chroma .kr{color:#204a87;font-weight:700}.chroma .kt{color:#204a87;font-weight:700}.chroma .n{color:#000}.chroma .na{color:#c4a000}.chroma .nb{color:#204a87}.chroma .bp{color:#3465a4}.chroma .nc{color:#000}.chroma .no{color:#000}.chroma .nd{color:#5c35cc;font-weight:700}.chroma .ni{color:#ce5c00}.chroma .ne{color:#c00;font-weight:700}.chroma .nf{color:#000}.chroma .fm{color:#000}.chroma .nl{color:#f57900}.chroma .nn{color:#000}.chroma .nx{color:#000}.chroma .py{color:#000}.chroma .nt{color:#204a87;font-weight:700}.chroma .nv{color:#000}.chroma .vc{color:#000}.chroma .vg{color:#000}.chroma .vi{color:#000}.chroma .vm{color:#000}.chroma .l{color:#000}.chroma .ld{color:#000}.chroma .s{color:#4e9a06}.chroma .sa{color:#4e9a06}.chroma .sb{color:#4e9a06}.chroma .sc{color:#4e9a06}.chroma .dl{color:#4e9a06}.chroma .sd{color:#8f5902;font-style:italic}.chroma .s2{color:#4e9a06}.chroma .se{color:#4e9a06}.chroma .sh{color:#4e9a06}.chroma .si{color:#4e9a06}.chroma .sx{color:#4e9a06}.chroma .sr{color:#4e9a06}.chroma .s1{color:#4e9a06}.chroma .ss{color:#4e9a06}.chroma .m{color:#0000cf;font-weight:700}.chroma .mb{color:#0000cf;font-weight:700}.chroma .mf{color:#0000cf;font-weight:700}.chroma .mh{color:#0000cf;font-weight:700}.chroma .mi{color:#0000cf;font-weight:700}.chroma .il{color:#0000cf;font-weight:700}.chroma .mo{color:#0000cf;font-weight:700}.chroma .o{color:#ce5c00;font-weight:700}.chroma .ow{color:#204a87;font-weight:700}.chroma .p{color:#000;font-weight:700}.chroma .c{color:#8f5902;font-style:italic}.chroma .ch{color:#8f5902;font-style:italic}.chroma .cm{color:#8f5902;font-style:italic}.chroma .c1{color:#8f5902;font-style:italic}.chroma .cs{color:#8f5902;font-style:italic}.chroma .cp{color:#8f5902;font-style:italic}.chroma .cpf{color:#8f5902;font-style:italic}.chroma .g{color:#000}.chroma .gd{color:#a40000}.chroma .ge{color:#000;font-style:italic}.chroma .gr{color:#ef2929}.chroma .gh{color:navy;font-weight:700}.chroma .gi{color:#00a000}.chroma .go{color:#000;font-style:italic}.chroma .gp{color:#8f5902}.chroma .gs{color:#000;font-weight:700}.chroma .gu{color:purple;font-weight:700}.chroma .gt{color:#a40000;font-weight:700}.chroma .gl{color:#000;text-decoration:underline}.chroma .w{color:#f8f8f8;text-decoration:underline}</style><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js></script><script src=/js/search.942bd26f5f9a4a6909fc6fe8467bf5e63314ad56a308f6cf706af97ea3b80f27.js integrity="sha256-lCvSb1+aSmkJ/G/oRnv15jMUrVajCPbPcGr5fqO4Dyc=" crossorigin=anonymous></script></head><body><article class=posts><header><div class=header-container><div class=flex-none><h1 class=title><a href=https://blog.yuzumone.net/>yuzumone's blog</a></h1></div><nav><ul class=flex-items><li class=header-item><a href=/>Home</a></li><li class=header-item><a href=/archives/>Archives</a></li></ul></nav></div><div class=header-line></div></header><main><div><h1 class=article-title>Migrating to null safety on Dart</h1><div class=header-container><time datetime=2021-03-21T00:00:00+00:00>ğŸ—“ March 21, 2021</time><div class=article-tag><p class=flex-items>ğŸ·ï¸</p><ul class=flex-items><li class=header-item><a href=/tags/dart>Dart</a></li></ul></div></div><details class=page-toc><summary>Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#check-dependency-status>Check dependency status</a></li><li><a href=#update-dependencies>Update dependencies</a></li><li><a href=#migrate>Migrate</a></li><li><a href=#analyze-and-test>Analyze & Test</a></li><li><a href=#finish>Finish</a></li></ul></nav></details></div><div><figure><img src="https://images.unsplash.com/photo-1612953117963-5fd4f0736aa8?w=800&amp;auto=format&amp;fit=crop&amp;q=60&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwcm9maWxlLXBhZ2V8MTZ8fHxlbnwwfHx8fHw%3D"><figcaption><h4>Photo by Jamie Davies on Unsplash</h4></figcaption></figure><p>ã„ã‚ˆã„ã‚ˆ Dart ã® null safety ãŒ stable ã¨ãªã‚Šã¾ã—ãŸï¼<br>ã“ã‚Œã¾ã§ä½•å›ã‹ç´¹ä»‹ã—ã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª ipaddr ã‚’ null safety ã«ã—ã¦ã„ãéç¨‹ã‚’ãƒ¡ãƒ¢ã—ã¦ãŠãã¾ã™ï¼<br>å‚è€ƒã¾ã§ã« pullrq ã¯ä¸‹è¨˜ã§ã™ï¼<br></p><p><a href=https://github.com/yuzumone/ipaddr/pull/27>Sound null safety</a><br></p><p>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã©ãŠã‚Šã«é€²ã‚ã¦ã„ãã¾ã™ï¼<br></p><p><a href=https://dart.dev/null-safety/migration-guide>Migrating to null safety</a><br></p><h2 id=check-dependency-status>Check dependency status</h2><p>ã¾ãšã¯ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ null safety ã«å¯¾å¿œã—ã¦ãªã„ã‚‚ã®ãŒãªã„ã‹ã‚’ç¢ºèªã—ã¾ã™ï¼<br>ã“ã“ã§ã¤ã¾ãšãã¨ä½•ã‚‚ã§ããªã„ã§ã™ï¼<br>ipaddr ã§ã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã»ã¼ä½¿ã£ã¦ã„ãªã„ã®ã§ä¸‹è¨˜ã®é€šã‚Šã§ã—ãŸï¼<br></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ dart pub outdated --mode<span class=o>=</span>null-safety
</span></span><span class=line><span class=cl>Showing dependencies that are currently not opted in to null-safety.
</span></span><span class=line><span class=cl><span class=o>[</span>âœ—<span class=o>]</span> indicates versions without null safety support.
</span></span><span class=line><span class=cl><span class=o>[</span>âœ“<span class=o>]</span> indicates versions opting in to null safety.Package Name  Current  Upgradable  Resolvable  Latestdev_dependencies:
</span></span><span class=line><span class=cl>pedantic      âœ—1.9.2   âœ“1.11.0     âœ“1.11.0     âœ“1.11.0
</span></span><span class=line><span class=cl><span class=nb>test</span>          âœ—1.15.7  âœ“1.16.5     âœ“1.16.5     âœ“1.16.52 upgradable dependencies are locked <span class=o>(</span>in pubspec.lock<span class=o>)</span> to older versions.
</span></span><span class=line><span class=cl>To update these dependencies, use <span class=sb>`</span>dart pub upgrade<span class=sb>`</span>.
</span></span></code></pre></div><h2 id=update-dependencies>Update dependencies</h2><p>ä¾å­˜é–¢ä¿‚ã«å•é¡ŒãŒç„¡ã‹ã£ãŸã®ã§ pub upgrade ã—ã¾ã™ï¼<br>null-safety ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã¦å®Ÿè¡Œã™ã‚‹ã¨ pubspec.yaml ã‚’ã„ã„æ„Ÿã˜ã«æ›¸ãæ›ãˆã¦ãã‚Œã¾ã™ï¼<br></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ dart pub upgrade --null-safety
</span></span><span class=line><span class=cl>$ git diff -U0
</span></span><span class=line><span class=cl>diff --git a/pubspec.yaml b/pubspec.yaml
</span></span><span class=line><span class=cl>index e20a246..24695a1 <span class=m>100644</span>
</span></span><span class=line><span class=cl>--- a/pubspec.yaml
</span></span><span class=line><span class=cl>+++ b/pubspec.yaml
</span></span><span class=line><span class=cl>@@ -10,2 +10,2 @@ dev_dependencies:
</span></span><span class=line><span class=cl>-  pedantic: ^1.8.0
</span></span><span class=line><span class=cl>-  test: ^1.6.0
</span></span><span class=line><span class=cl>+  pedantic: ^1.11.0
</span></span><span class=line><span class=cl>+  test: ^1.16.5
</span></span><span class=line><span class=cl>$ dart pub get
</span></span></code></pre></div><h2 id=migrate>Migrate</h2><p>ã„ã‚ˆã„ã‚ˆ migrating ã§ã™ï¼<br>ã‚µãƒãƒ¼ãƒˆãƒ„ãƒ¼ãƒ«ãŒã‚ã‚‹ã®ã§ä¸‹è¨˜ã®é€šã‚Šå®Ÿè¡Œã—ã¾ã™ï¼<br>Web GUI ã‚’è¦‹ã‚ã¨è¨€ã‚ã‚Œã‚‹ã®ã§è¦‹ã¾ã™ï¼<br></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ dart migrate
</span></span></code></pre></div><p>ã‚ã¨ã¯ <em><strong>!</strong></em> maker ã‚’ä»˜ã‘ã¦ non-nullable ã§ã‚ã‚‹ã“ã¨ã‚’æŒ‡å®šã™ã‚‹ãªã©ã‚’è¡Œã£ã¦ã„ãã¾ã™ï¼<br>çµ‚ã‚ã£ãŸã‚‰ APPLY MIGRATION ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§é©å¿œã•ã‚Œã¾ã™ï¼<br>ã‚ã£ã¡ã‚ƒæ¥½ã§ã™ã­ï¼<br></p><p>IPv4Address ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã¯ null ã‚’è¨±å®¹ã—ãªã„ã‚ˆã†ã«ãªã‚‹ã®ã§ null ãƒã‚§ãƒƒã‚¯ãŒå¸¸ã« false ã«ãªã‚‹ãªã©ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã™ï¼<br>ignore: unnecessary_null_comparison ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§å¼•ãç¶šã null check ã‚’è¨˜è¼‰ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ï¼<br></p><h2 id=analyze-and-test>Analyze & Test</h2><p>migrating ãŒçµ‚ã‚ã£ãŸã‚‰ã‚³ãƒ¼ãƒ‰è§£æã¨ãƒ†ã‚¹ãƒˆã‚‚å¿˜ã‚Œãšã«ã‚„ã£ã¦ãŠãã¾ã™ï¼<br></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ dart analyze
</span></span><span class=line><span class=cl>$ dart <span class=nb>test</span>
</span></span></code></pre></div><h2 id=finish>Finish</h2><p>ã¯ã„ï¼Œã“ã‚Œã§çµ‚äº†ã§ã™ï¼<br>ã‚µãƒãƒ¼ãƒˆãƒ„ãƒ¼ãƒ«ãŒä¾¿åˆ©ãªã®ã§ã‚ã£ã‘ãªãçµ‚ã‚ã‚Šã¾ã—ãŸï¼<br>package version ã¯ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚ã’ã‚‹ã“ã¨ã‚’æ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã®ã§ï¼Œç‰¹ã«å¼·ã„ã“ã ã‚ã‚ŠãŒãªã‘ã‚Œã°ãã‚Œã§è‰¯ã•ãã†ã§ã™ï¼<br></p></div></main><footer><section><p>Â© 2025 yuzumone's blog All rights reserved.</p></section></footer></article></body></html>