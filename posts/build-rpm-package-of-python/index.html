<!doctype html><html lang=ja-jp dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Build RPM Package of Python | yuzumone's blog</title>
<meta name=description content="
    
  "><meta name=keywords content="
    
  "><meta name=Hatena::Bookmark content="nocomment"><style>@import 'https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+JP:wght@400;600&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Noto+Color+Emoji&family=Secular+One&display=swap'</style><link rel=stylesheet href=/css/main.min.2421e6cca60bf0bd0ce22a86e5391b0a7b5bbd939bf4e3d651fd3384307eba3b.css integrity="sha256-JCHmzKYL8L0M4iqG5TkbCntbvZOb9OPWUf0zhDB+ujs=" crossorigin=anonymous><style>.bg{background-color:#f8f8f8}.chroma{background-color:#f8f8f8}.chroma .x{color:#000}.chroma .err{color:#a40000}.chroma .cl{}.chroma .lnlinks{outline:none;text-decoration:none;color:inherit}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0}.chroma .hl{background-color:#dfdfdf}.chroma .lnt{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .ln{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .line{display:flex}.chroma .k{color:#204a87;font-weight:700}.chroma .kc{color:#204a87;font-weight:700}.chroma .kd{color:#204a87;font-weight:700}.chroma .kn{color:#204a87;font-weight:700}.chroma .kp{color:#204a87;font-weight:700}.chroma .kr{color:#204a87;font-weight:700}.chroma .kt{color:#204a87;font-weight:700}.chroma .n{color:#000}.chroma .na{color:#c4a000}.chroma .nb{color:#204a87}.chroma .bp{color:#3465a4}.chroma .nc{color:#000}.chroma .no{color:#000}.chroma .nd{color:#5c35cc;font-weight:700}.chroma .ni{color:#ce5c00}.chroma .ne{color:#c00;font-weight:700}.chroma .nf{color:#000}.chroma .fm{color:#000}.chroma .nl{color:#f57900}.chroma .nn{color:#000}.chroma .nx{color:#000}.chroma .py{color:#000}.chroma .nt{color:#204a87;font-weight:700}.chroma .nv{color:#000}.chroma .vc{color:#000}.chroma .vg{color:#000}.chroma .vi{color:#000}.chroma .vm{color:#000}.chroma .l{color:#000}.chroma .ld{color:#000}.chroma .s{color:#4e9a06}.chroma .sa{color:#4e9a06}.chroma .sb{color:#4e9a06}.chroma .sc{color:#4e9a06}.chroma .dl{color:#4e9a06}.chroma .sd{color:#8f5902;font-style:italic}.chroma .s2{color:#4e9a06}.chroma .se{color:#4e9a06}.chroma .sh{color:#4e9a06}.chroma .si{color:#4e9a06}.chroma .sx{color:#4e9a06}.chroma .sr{color:#4e9a06}.chroma .s1{color:#4e9a06}.chroma .ss{color:#4e9a06}.chroma .m{color:#0000cf;font-weight:700}.chroma .mb{color:#0000cf;font-weight:700}.chroma .mf{color:#0000cf;font-weight:700}.chroma .mh{color:#0000cf;font-weight:700}.chroma .mi{color:#0000cf;font-weight:700}.chroma .il{color:#0000cf;font-weight:700}.chroma .mo{color:#0000cf;font-weight:700}.chroma .o{color:#ce5c00;font-weight:700}.chroma .ow{color:#204a87;font-weight:700}.chroma .p{color:#000;font-weight:700}.chroma .c{color:#8f5902;font-style:italic}.chroma .ch{color:#8f5902;font-style:italic}.chroma .cm{color:#8f5902;font-style:italic}.chroma .c1{color:#8f5902;font-style:italic}.chroma .cs{color:#8f5902;font-style:italic}.chroma .cp{color:#8f5902;font-style:italic}.chroma .cpf{color:#8f5902;font-style:italic}.chroma .g{color:#000}.chroma .gd{color:#a40000}.chroma .ge{color:#000;font-style:italic}.chroma .gr{color:#ef2929}.chroma .gh{color:navy;font-weight:700}.chroma .gi{color:#00a000}.chroma .go{color:#000;font-style:italic}.chroma .gp{color:#8f5902}.chroma .gs{color:#000;font-weight:700}.chroma .gu{color:purple;font-weight:700}.chroma .gt{color:#a40000;font-weight:700}.chroma .gl{color:#000;text-decoration:underline}.chroma .w{color:#f8f8f8;text-decoration:underline}</style><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js></script><script src=/js/search.942bd26f5f9a4a6909fc6fe8467bf5e63314ad56a308f6cf706af97ea3b80f27.js integrity="sha256-lCvSb1+aSmkJ/G/oRnv15jMUrVajCPbPcGr5fqO4Dyc=" crossorigin=anonymous></script></head><body><article class=posts><header><div class=header-container><div class=flex-none><h1 class=title><a href=https://blog.yuzumone.net/>yuzumone's blog</a></h1></div><nav><ul class=flex-items><li class=header-item><a href=/>Home</a></li><li class=header-item><a href=/archives/>Archives</a></li></ul></nav></div><div class=header-line></div></header><main><div><h1 class=article-title>Build RPM Package of Python</h1><div class=header-container><time datetime=2020-07-05T00:00:00+00:00>üóì July 5, 2020</time><div class=article-tag><p class=flex-items>üè∑Ô∏è</p><ul class=flex-items><li class=header-item><a href=/tags/python>Python</a></li></ul></div></div></div><div><figure><img src="https://images.unsplash.com/photo-1577702312706-e23ff063064f?w=800&amp;auto=format&amp;fit=crop&amp;q=60&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwcm9maWxlLXBhZ2V8OHx8fGVufDB8fHx8fA%3D%3D"><figcaption><h4>Photo by Brandable Box on Unsplash</h4></figcaption></figure><p>Python „Éë„ÉÉ„Ç±„Éº„Ç∏„ÅÆ RPM Âåñ„Å®„ÅÑ„Åà„Å∞ bdist_rpm „Åå„ÅÇ„Çä„Åæ„Åô„ÅåÔºå„Åì„ÅÆÂ†¥Âêà‰æùÂ≠ò„Éë„ÉÉ„Ç±„Éº„Ç∏„ÇÇ PRM Âåñ„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„ÅôÔºé<br>„Å®„ÅÑ„ÅÜ„Åì„Å®„Åß venv „Åß„ÅÑ„ÅÑÊÑü„Åò„Å´„Éë„ÉÉ„Ç±„Éº„Ç∏Âåñ„Åô„Çã„Å®„Åç„ÅÆ spec „Éï„Ç°„Ç§„É´„ÅÆÂÜÖÂÆπ„Çí„É°„É¢Ôºé<br></p><p>„Å®„ÅÑ„ÅÜ„Åì„Å®„Åß‰∏ãË®ò„Åß„ÅôÔºé<br></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-spec data-lang=spec><span class=line><span class=cl><span class=cp>%define venv_name package_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>%define venv_install_dir /opt/%{venv_name}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>%define venv_dir %{buildroot}%{venv_install_dir}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>%define venv_bin %{venv_dir}/bin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>%define __prelink_undo_cmd %{nil}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>%undefine<span class=w> </span>__arch_install_post<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>%global<span class=w> </span>__os_install_post<span class=w> </span>%(echo<span class=w> </span><span class=s1>&#39;%{__os_install_post}&#39;</span><span class=w> </span>|<span class=w> </span>sed<span class=w> </span>-e<span class=w> </span><span class=s1>&#39;s!/usr/lib[^[:space:]]*/brp-python-bytecompile[[:space:]].*$!!g&#39;</span>)<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=gh>Name</span><span class=p>:</span><span class=w>       </span>package_name<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=gh>Version</span><span class=p>:</span><span class=w>    </span><span class=kc>%{package_version}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=gh>Release</span><span class=p>:</span><span class=w>    </span>1<span class=nv>%{?dist}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=gh>Summary</span><span class=p>:</span><span class=w>    </span>package_summary<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=gh>URL</span><span class=p>:</span><span class=w>        </span>https://github.com/hoge/huga<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=gh>Source0</span><span class=p>:</span><span class=w>    </span>./<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=gh>Requires</span><span class=p>:</span><span class=w>   </span>python3%description<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>long_package_desccription%prep<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>rm<span class=w> </span>-rf<span class=w> </span><span class=kc>%{buildroot}</span>/*%install<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>install<span class=w> </span>-d<span class=w> </span><span class=kc>%{buildroot}%{venv_install_dir}</span><span class=w> </span><span class=kc>%{buildroot}</span>/usr/sbin<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>python3<span class=w> </span>-m<span class=w> </span>venv<span class=w> </span><span class=kc>%{venv_dir}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kc>%{venv_bin}</span>/python<span class=w> </span><span class=kc>%{venv_bin}</span>/pip<span class=w> </span>install<span class=w> </span>--upgrade<span class=w> </span>pip<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kc>%{venv_bin}</span>/python<span class=w> </span><span class=kc>%{venv_bin}</span>/pip<span class=w> </span>install<span class=w> </span>venvctrl<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>cd<span class=w> </span><span class=kp>%{_topdir}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kc>%{venv_bin}</span>/python<span class=w> </span>setup.py<span class=w> </span>install<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>ln<span class=w> </span>-sf<span class=w> </span><span class=kc>%{venv_install_dir}</span>/bin/package_name<span class=w> </span><span class=kc>%{buildroot}</span>/usr/sbin/package_name<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>find<span class=w> </span><span class=kc>%{buildroot}</span><span class=w> </span>-name<span class=w> </span><span class=s2>&#34;RECORD&#34;</span><span class=w> </span>-exec<span class=w> </span>rm<span class=w> </span>-rf<span class=w> </span>{}<span class=w> </span>\;<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kc>%{venv_bin}</span>/venvctrl-relocate<span class=w> </span>--source=<span class=kc>%{venv_dir}</span><span class=w> </span>--destination=<span class=kc>%{venv_install_dir}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>find<span class=w> </span><span class=kc>%{venv_dir}</span>/lib<span class=w> </span>-type<span class=w> </span>f<span class=w> </span>-name<span class=w> </span><span class=s2>&#34;*.so&#34;</span><span class=w> </span>|<span class=w> </span>xargs<span class=w> </span>-r<span class=w> </span>strip%files<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kc>%{venv_install_dir}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>/usr/sbin/package_name%clean<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>rm<span class=w> </span>-rf<span class=w> </span><span class=kc>%{buildroot}</span><span class=w>
</span></span></span></code></pre></div><p>ËªΩ„ÅèËß£Ë™¨„ÇíÊõ∏„Åè„Å® /opt ÈÖç‰∏ã„Å´ pip install „Çí„ÇÑ„Å£„Åü„ÅÇ„Å® /usr/sbin ÈÖç‰∏ã„Å´„Ç∑„É≥„Éú„É™„ÉÉ„ÇØ„É™„É≥„ÇØ„ÇíÂºµ„Å£„Å¶„ÅÑ„Åæ„ÅôÔºé<br>CUI „ÉÑ„Éº„É´„Å™„Å©„Åß„Çà„Åè„ÅÇ„Çã„Éë„Çø„Éº„É≥„Åã„Å®ÊÄù„ÅÑ„Åæ„ÅôÔºé<br>Cent6 „Å® Cent7 „ÅßÂãï„Åè„Åì„Å®„ÅØÁ¢∫Ë™ç„Åó„Å¶„ÅÑ„Çã„ÅÆ„ÅßÂ§ß‰∏àÂ§´„ÅÆ„ÅØ„ÅöÔºé<br></p><p>„ÅÇ„Å®ÂΩì„Åü„ÇäÂâç„Å™„Çì„Åß„Åô„Åë„Å© venv „Åå activate Áä∂ÊÖã„Åß rpmbuild „Åô„Çã„Å® venv „ÅÆ Python „Åß„Éë„ÉÉ„Ç±„Éº„Ç∏„Åå‰ΩúÊàê„Åï„Çå„Çã„ÅÆ„ÅßÊ≥®ÊÑè„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºé<br></p></div></main><footer><section><p>¬© 2025 yuzumone's blog All rights reserved.</p></section></footer></article></body></html>